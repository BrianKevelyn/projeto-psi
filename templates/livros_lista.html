{% extends 'base.html' %}

{% block content %}
<h2>Catálogo de Livros</h2>

{% if livros %}
<link rel="stylesheet" href="{{ url_for('static', filename='livros_lista.css') }}">
<div class="livros-container">
  {% for livro in livros %}
    <div class="livro-card">
      
      <div class="livro-info">
        <h3>{{ livro.liv_titulo }}</h3>
        <p class="autor">Por {{ livro.liv_autor }}</p>
        <p class="preco">R$ {{ "%.2f"|format(livro.liv_preco) }}</p>

        {% if livro.liv_quantidade > 0 %}
            <p class="disponivel">Quantidade: {{ livro.liv_quantidade }}</p>
        {% else %}
            <p class="esgotado">Esgotado</p>
        {% endif %}

        {% if current_user.usu_tipo == "bibliotecario" %}
        <div class="btns-admin">
          <a href="{{ url_for('livros.editar_livro', livro_id=livro.liv_id) }}" class="btn-editar">Editar</a>
          <form method="POST" action="{{ url_for('livros.excluir_livro', livro_id=livro.liv_id) }}">
            <button type="submit" class="btn-excluir">Excluir</button>
          </form>
        </div>
        {% endif %}

        {% if current_user.usu_tipo != "bibliotecario" %}
          {% if livro.liv_quantidade > 0 %}
            <form method="POST" action="{{ url_for('livros.comprar_livro', livro_id=livro.liv_id) }}">
              <button type="submit" class="btn-comprar">Comprar</button>
            </form>
          {% else %}
            <button class="btn-esgotado" disabled>Esgotado</button>
          {% endif %}
        {% endif %}

      </div>
    </div>
  {% endfor %}
</div>
{% else %}
<p>Não há livros cadastrados.</p>
{% endif %}
<div class="acoes">
  {% if current_user.usu_tipo == "bibliotecario" %}
    <a href="{{ url_for('livros.adicionar_livro') }}" class="btn-adicionar">Adicionar novo livro</a>
  {% endif %}
  
  <a href="{{ url_for('main.index') }}" class="btn-voltar_inicio">Voltar</a>
  {% endblock %}
</div>

